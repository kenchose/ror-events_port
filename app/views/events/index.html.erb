<!-- CREATE MODAL ASKING IF YOU'RE SURE YOU WANT TO SIGN OUT-->
<% if flash[:errors] %>
    <div class="ui negative message">
        <i class="close icon"></i>
        <div class="header">
            <h3>There are some errors with your submission</h3>
        <% flash[:errors].each do |e| %>
            <ul class="list">
                <li><%= e %></li>
            </ul>
        <% end %>
        </div>
    </div>
<% end %>

<section id="instate_events">
    <div class="instate-wrapper">
        <div class="ui horizontal divider"><h2>Here are some awesome events in your state that you won't regret going!</h2></div>
        <table class="ui celled table raised segment">
            <thead class="ui center aligned header raised segment">
                <tr>
                    <th id="left-name" class="ui red ribbon label">Event Name</th>
                    <th>Date</th>
                    <th>Details</th>
                    <th>Location</th>
                    <th>Host</th>
                    <th>Attending</th>
                    <th>Action/Status</th>
                </tr>
            </thead>
            <tbody>
            <% @events.each do |event| %> 
                <% if event.state  == current_user.state  %>
                    <tr>
                        <td><a href= "/events/<%= event.id %>"><%= event.name %></a></td> 
                        <td><%= event.date.strftime("%B %d, %Y") %></td>
                        <td><%= event.detail %></td>
                        <td><%= event.city %></td>
                        <td><%= event.user.first_name %> <%= event.user.last_name %></td>
                        <td>
                            <div class="ui compact menu">
                                <div class="item">
                                    <i class="icon users"></i> People
                                    <div class="floating ui teal label"><%= event.joins.count %></div> <!--use statics from semantic ui people are attending-->
                                </div>
                            </div>
                        </td>
                        <% if current_user.joining_event.ids.include? (event.id) %>

                        
                            <!-- Join toggle button works great -->
                            
                            
                            <td>
                                <form action="/joins/<%= event.id %>" method="post">
                                    <input type="hidden" name="authenticity_token" value="<%= form_authenticity_token %>">
                                    <input type="hidden" name="_method" value="delete">
                                    <button class="negative ui toggle button" type="submit">Cancel Event</button>
                                </form>
                            </td>


                        <% elsif %>
                            <% if current_user == event.user %>
                            <td><button class="ui primary button"><a class="edit-button" href="events/<%= event.id %>/edit">Edit</a></button>
                                <!-- <td> -->
                                    <button class="delete-event">
                                        <div class="ui positive fluid animated fade button">
                                            <div class="visible content">Delete Event</div>
                                            <div class="hidden content"><i class="trash icon"></i></div>
                                        </div>      
                                    </button>        
                                        <div class="ui small test modal">
                                            <div class="header">Delete Event</div>
                                            <div class="content">
                                                <p>Are you sure you want to delete this event?</p>
                                                <div class="actions">
                                                    <form action="/events/<%= event.id %>" method="post" class="ui form">
                                                        <input type="hidden" name="authenticity_token" value="<%= form_authenticity_token %>">
                                                        <input type="hidden" name="_method" value="delete">    
                                                        <div class="ui red cancel button">Cancel</div>
                                                        <button type="submit"><div class="ui positive right labeled icon button">Yes
                                                            <i class="checkmark icon"></i></div>
                                                        </button>
                                                    </form>
                                                </div>
                                            </div>
                                        </div>
                                        <!-- <button>Delete
                                        <form class="ui mini modal" action="/events/<%= event.id %>" method="post">
                                            <input type="hidden" name="authenticity_token" value="<%= form_authenticity_token%>">
                                            <input type="hidden" name="_method" value="delete">
                                            <div class="fform">Delete Event</div>
                                            <div class="content">
                                                <p>Are you sure you want to delete this event?</p>
                                            </div>
                                            <div class="actions">
                                                <button class="ui approve button">Yes</button>
                                                <button class="ui cancel button">No</button>
                                            </div>
                                        </form>
                                    </button> -->
                                              
                                    <!-- <form action="/events/<%= event.id %>" method="post">
                                        <input type="hidden" name="authenticity_token" value="<%= form_authenticity_token %>">
                                        <input type="hidden" name="_method" value="delete">
                                        <button type="submit" id="delete">
                                            <div class="positive ui fluid animated button">
                                                <div class="visible content">Delete Event</div>
                                                <div class="hidden content">Are you sure?</div>
                                            </div>      
                                        </button>                       
                                     </form> -->
                                <!-- </td> -->
                            </td>
                            <% end %> 
                        <% else %>
                            <td>
                                <form action="/joins/<%= event.id %>" method="post">
                                    <input type="hidden" name="authenticity_token" value="<%= form_authenticity_token %>">
                                    <button class="ui button">Join</button>
                                </form>
                            </td>
                        <% end %>
                    </tr>
                <% end %>
            <% end %>
            </tbody>
        </table>
    </div>
</section>

<section id="outstate_events">
    <div class="outstate-wrapper">
        <div class="ui horizontal divider"><h2>Here are some out of state events that are going on!</h2></div>
        <table class="ui celled table raised segment">
            <thead class="ui center aligned header raised segment">
                <tr>
                    <th id="left-name" class="ui ribbon red label">Event Name</th>
                    <th>Date</th>
                    <th>City</th>
                    <th>State</th>
                    <th>Host</th>
                    <th>Action/Status</th>
                </tr>
            </thead>
            <tbody>
            <% @events.each do |event|%>
                <% if event.state != current_user.state %>
                    <tr>
                        <td><a href= "/events/<%= event.id %>"><%= event.name %></a></td> 
                        <td><%= event.date.strftime("%B %d, %Y") %></td>
                        <td><%= event.city %></td>
                        <td><%= event.state %></td>
                        <td><a href="users/<%= event.user.id %>"><%= event.user.first_name %> <%= event.user.last_name %></a></td>
                        <% if current_user.joining_event.ids.include? (event.id) %>



                        <!-- <td>Joining workd well</td> -->
                        
                        
                        
                        
                        <td>
                            <form action="/joins/<%= event.id %>" method="post">
                                <input type="hidden" name="authenticity_token" value="<%= form_authenticity_token %>">
                                <input type="hidden" name="_method" value="delete">
                                <button class="negative ui toggle button" type="submit">Cancel Event</button>
                            </form>
                        </td>
                        <% elsif %>
                            <% if current_user == event.user %>
                            <td><button class="ui primary button"><a class="edit-button" href="events/<%= event.id %>/edit">Edit</a></button>
                     
                                <button id="delete-event">
                                    <div class="ui positive fluid animated fade button">
                                        <div class="visible content">Delete Event</div>
                                        <div class="hidden content"><i class="trash icon"></i></div>
                                    </div>      
                                </button> 
                                <div class="ui small modal">
                                    <div class="header">Delete Event?</div>
                                    <div class="content">
                                        <p>Are you sure you want to delete this event?</p>
                                        <div class="actions">
                                            <form action="/events/<%= event.id %>" method="post">
                                                <input type="hidden" name="authenticity_token" value="<%= form_authenticity_token %>">
                                                <input type="hidden" name="_method" value="delete">            
                                                <button type="submit" class="ui green button yes">Yes</button>
                                                <div class="ui red cancel button">Cancel</div>
                                            </form>
                                        </div>
                                    </div>
                                </div>
           
    
                                <!-- <form action="/events/<%= event.id %>" method="post">
                                    <input type="hidden" name="authenticity_token" value="<%= form_authenticity_token %>">
                                    <input type="hidden" name="_method" value="delete">
                                    <button type="submit" id="delete">
                                        <div class="positive ui fluid animated button">
                                            <div class="visible content">Delete Event</div>
                                            <div class="hidden content">Are you sure?</div>
                                        </div>      
                                    </button>
                                </form> -->

                            </td>
                            <% end %>
                        <% else %>
                        <td>
                            <form action="/joins/<%= event.id %>" method="post">
                                <input type="hidden" name="authenticity_token" value="<%= form_authenticity_token %>">
                                <button class="ui toggle button">Join</button>
                            </form>
                        </td>
                        <% end %>
                    </tr>
                <% end %>
            <% end %>
            </tbody>
        </table>
    </div>
</section>

<section id="add_event">
    <div class="ui event container">
        <form action="/events" method="post" class="ui form add-event">
            <input type="hidden" name="authenticity_token" value="<%= form_authenticity_token %>">
            <input type="hidden" name="event[user_id]" value="<%= current_user.id %>">
            <div class="two four wide field">
                    <div class="field">
                        <label for="name"><i class="birthday cake icon"></i>Event Name</label>
                        <input  type="text" name="event[name]" placeholder="Name">
                    </div>
                    <div class="field ui calendar">
                        <label for="date"><i class="calendar alternate icon"></i>Date</label>
                        <input type="date" name="event[date]" placeholder="Date" min="<%= @today %>">
                    </div>
                </div>
                <div class="ui eight wide field">
                    <label for="deatil"><i class="newspaper icon"></i>Details</label>
                    <textarea class="field" name="event[detail]" cols="60" rows="10" placeholder="Event details"></textarea>
                </div>
                <div class="two fields">
                    <div class="four wide field">
                        <label for="location"><i class="map marker alternate icon"></i>Location</label>
                        <input type="text" name="event[city]" placeholder="City">
                    </div>
                    <div class="two wide field">
                        <label for="state">State</label>
                        <select class="ui fluid dropdown" name="event[state]">
                            <option value="" selected="selected">Select a State</option>
                            <option value="AL">Alabama</option>
                            <option value="AK">Alaska</option>
                            <option value="AZ">Arizona</option>
                            <option value="AR">Arkansas</option>
                            <option value="CA">California</option>
                            <option value="CO">Colorado</option>
                            <option value="CT">Connecticut</option>
                            <option value="DE">Delaware</option>
                            <option value="DC">District Of Columbia</option>
                            <option value="FL">Florida</option>
                            <option value="GA">Georgia</option>
                            <option value="HI">Hawaii</option>
                            <option value="ID">Idaho</option>
                            <option value="IL">Illinois</option>
                            <option value="IN">Indiana</option>
                            <option value="IA">Iowa</option>
                            <option value="KS">Kansas</option>
                            <option value="KY">Kentucky</option>
                            <option value="LA">Louisiana</option>
                            <option value="ME">Maine</option>
                            <option value="MD">Maryland</option>
                            <option value="MA">Massachusetts</option>
                            <option value="MI">Michigan</option>
                            <option value="MN">Minnesota</option>
                            <option value="MS">Mississippi</option>
                            <option value="MO">Missouri</option>
                            <option value="MT">Montana</option>
                            <option value="NE">Nebraska</option>
                            <option value="NV">Nevada</option>
                            <option value="NH">New Hampshire</option>
                            <option value="NJ">New Jersey</option>
                            <option value="NM">New Mexico</option>
                            <option value="NY">New York</option>
                            <option value="NC">North Carolina</option>
                            <option value="ND">North Dakota</option>
                            <option value="OH">Ohio</option>
                            <option value="OK">Oklahoma</option>
                            <option value="OR">Oregon</option>
                            <option value="PA">Pennsylvania</option>
                            <option value="RI">Rhode Island</option>
                            <option value="SC">South Carolina</option>
                            <option value="SD">South Dakota</option>
                            <option value="TN">Tennessee</option>
                            <option value="TX">Texas</option>
                            <option value="UT">Utah</option>
                            <option value="VT">Vermont</option>
                            <option value="VA">Virginia</option>
                            <option value="WA">Washington</option>
                            <option value="WV">West Virginia</option>
                            <option value="WI">Wisconsin</option>
                            <option value="WY">Wyoming</option>
                        </select>    
                    </div>
                </div>
                <button class="ui red button four wide field" type="submit">Add Event</button>
            </div>
        </form>
    </div>
</section>

<!-- <div class="ui modal">
            <div class="header">Delete Event?</div>
            <div class="content">
                <p>Are you sure you want to delete this event?</p>
            </div>
            <div class="actions">
                <div class="ui green approve button">Yes</div>
                <div class="ui red cancel button">Cancel</div>
            </div>
        </div> -->

